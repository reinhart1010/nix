<h1 id="trdsql">trdsql</h1>

<p>Ejecuta SQL en archivos CSV, LTSV, JSON, YAML y TBLN.
Más información: <a href="https://noborus.github.io/trdsql/">https://noborus.github.io/trdsql/</a>.</p>

<ul>
  <li>Convierte datos de objetos de varios archivos JSON a un archivo CSV con encabezado (<code class="language-plaintext highlighter-rouge">-oh</code>) y comillas dobles:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">trdsql -ocsv -oh "SELECT * FROM </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">ruta/al/archivo/*.json</span><code class="language-plaintext highlighter-rouge">" | sed 's/\([^,]*\)/«&amp;»/g' &gt; </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">ruta/al/archivo.csv</span></p>

<ul>
  <li>Interpreta una lista JSON como tabla y pone objetos dentro como columnas ( ruta/al/archivo.json: <code class="language-plaintext highlighter-rouge">{"lista":[{"edad":"26", "nombre":"Tanaka"}]}</code>):</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">trdsql "SELECT * FROM </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">ruta/al/archivo.json</span><code class="language-plaintext highlighter-rouge">::.list</code></p>

<ul>
  <li>Manipula una consulta SQL compleja con datos de varios archivos CSV cuya primera línea es la cabecera (<code class="language-plaintext highlighter-rouge">-ih</code>):</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">trdsql -icsv -ih "SELECT </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">columna1,columna2</span><code class="language-plaintext highlighter-rouge"> FROM </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">ruta/al/archivo*.csv</span><code class="language-plaintext highlighter-rouge"> WHERE column2 != '' ORDER BY columna1 GROUP BY columna1"</code></p>

<ul>
  <li>Combina el contenido de 2 archivos CSV en un archivo CSV:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">trdsql "SELECT </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">columna1,columna2</span><code class="language-plaintext highlighter-rouge"> FROM </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">ruta/al/archivo1.csv</span><code class="language-plaintext highlighter-rouge"> UNION SELECT </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">columna1,columna2</span><code class="language-plaintext highlighter-rouge"> FROM </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">ruta/al/archivo2.csv</span><code class="language-plaintext highlighter-rouge">"</code></p>

<ul>
  <li>Se conecta a la base de datos PostgreSQL:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">trdsql -driver postgres -dsn "host=</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">nombre_del_host</span><code class="language-plaintext highlighter-rouge"> port=</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">5433</span><code class="language-plaintext highlighter-rouge"> dbname=</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">nombre_de_la_base_de_datos</span><code class="language-plaintext highlighter-rouge">" "SELECT 1"</code></p>

<ul>
  <li>Crea una tabla de datos en una base de datos MySQL a partir de un archivo CSV:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">trdsql -driver mysql -dsn "</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">usuario</span><code class="language-plaintext highlighter-rouge">:</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">contraseña</span><code class="language-plaintext highlighter-rouge">@</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">nombre_del_host</span><code class="language-plaintext highlighter-rouge">/</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">base_de_datos</span><code class="language-plaintext highlighter-rouge">" -ih "CREATE TABLE </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">tabla</span><code class="language-plaintext highlighter-rouge"> (</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">columna1</span><code class="language-plaintext highlighter-rouge"> int, </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">columna2</span><code class="language-plaintext highlighter-rouge"> varchar(20)) AS SELECT </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">columna3</span><code class="language-plaintext highlighter-rouge"> AS </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">columna1</span><code class="language-plaintext highlighter-rouge">,</code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">columna2</span><code class="language-plaintext highlighter-rouge"> FROM </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">ruta/a/archivo_cabecera.csv</span><code class="language-plaintext highlighter-rouge">"</code></p>

<ul>
  <li>Muestra datos de archivos de registro comprimidos:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">trdsql -iltsv "SELECT * FROM </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">ruta/a/acceso.log.gz</span><code class="language-plaintext highlighter-rouge">"</code></p>
