<h1 id="virt-sysprep">virt-sysprep</h1>

<p>Reset, unconfigure, or customize a virtual machine image.
More information: <a href="https://manned.org/virt-sysprep">https://manned.org/virt-sysprep</a>.</p>

<ul>
  <li>List all supported operations (enabled operations are indicated with asterisks):</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">virt-sysprep --list-operations</code></p>

<ul>
  <li>Remove sensitive system data from a virtual machine image:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">sudo virt-sysprep --add </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">path/to/image.qcow2</span></p>

<ul>
  <li>Specify a virtual machine by its name and run all enabled operations but don't actually apply the changes:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">sudo virt-sysprep --domain </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">vm_name</span><code class="language-plaintext highlighter-rouge"> --dry-run</code></p>

<ul>
  <li>Run only the specified operations:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">sudo virt-sysprep --domain </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">vm_name</span><code class="language-plaintext highlighter-rouge"> --operations </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">operation1,operation2,â€¦</span></p>

<ul>
  <li>Generate a new <code class="language-plaintext highlighter-rouge">/etc/machine-id</code> file and enable customizations to be able to change the host name to avoid network conflicts:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">sudo virt-sysprep --domain </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">vm_name</span><code class="language-plaintext highlighter-rouge"> --enable </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">customizations</span><code class="language-plaintext highlighter-rouge"> --hostname </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">host_name</span><code class="language-plaintext highlighter-rouge"> --operation </code><span class="tldr-var badge badge-pill bg-dark-lm bg-white-dm text-white-lm text-dark-dm font-weight-bold">machine-id</span></p>
